-module(user_lib).
-compile(export_all).
-define(SECRET_STRING, "Secret string").

root_cookie(N, V) ->
    mochiweb_cookies:cookie(N, V, [{path, "/"}]).

hash_password(Password, Salt) ->
    mochihex:to_hex(erlang:md5(Salt ++ Password)).

hash_for(Name, Password) ->
    Salt = mochihex:to_hex(erlang:md5(Name)),
    ComputedHash = hash_password(Password, Salt),
    ComputedHash.

session_id(Id) ->
    mochihex:to_hex(erlang:md5(?SECRET_STRING ++ Id)).
